<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Chess</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="main">
        <div id="game_board" class="board"></div>
        <div class="info">
            <div class="bold" id="current_turn"></div>
            <div id="moves_container"><table id="moves"></table></div>
        </div>
        <div class="ia">
            <div id="thinking" class="bold"></div>
            <br>
            <div>Current Board Evaluation : <span id="evaluation"></span></div>
            <br>
            <div>Search tree depth : <input id="search_depth" type="number" min="1"></div>
            <br>
            <div>Searched nodes : <span id="searched_nodes"></span></div>
        </div>
    </div>

    <script src="game.js"></script>
    <script src="gui.js"></script>
    <script>
    let game = {
        //"board": [["r", "n", "b", "q", "k", "b", "n", "r"], ["p", "p", "p", "p", "p", "p", "p", "p"], ["", "", "", "", "", "", "", ""], ["", "", "", "", "", "", "", ""], ["", "", "", "", "", "", "", ""], ["", "", "", "", "", "", "", ""], ["P", "P", "P", "P", "P", "P", "P", "P"], ["R", "N", "B", "Q", "K", "B", "N", "R"]],

        "board": [["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","q","","","",""],["","q","","","","","",""],["","","","","","","","K"],["","","","","","","",""]],
        "current_turn": "w",
        "player_color": "w",
        "moves": [],
        "check": [],
        "checkmate": "",
        "stalemate": false
    };

    let gui = new GUI("game_board", game);
    let ai = new Worker("ai.js");

    ai.play = function(){
        ai.postMessage({"cmd": "play", "data": game});
    };
    document.getElementById("search_depth").onchange = function(e){
        ai.postMessage({"cmd": "set_search_depth", "data": parseInt(this.value)});
    };
    document.getElementById("search_depth").value = 3;

    ai.onmessage = function(e){
        let cmd = e.data["cmd"];
        let data = e.data["data"];
        switch(cmd){
            case "play":
                play(data[0], data[1], game);
                break;
            case "info":
                document.getElementById("searched_nodes").innerHTML = data;
                break;
        }
    };
    </script>
</body>
</html>